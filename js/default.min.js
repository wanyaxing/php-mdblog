function ready(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}function afterLoad(e){"complete"==document.readyState?e():window.addEventListener?window.addEventListener("load",e,!1):window.attachEvent?window.attachEvent("onload",e):window.onload=e}afterLoad(function(){function e(e,t){for(var n=0;n<e.length;n++)t(n,e[n])}function t(e,t,n,o){var i=new XMLHttpRequest;i.open(e,t,!0),"POST"==e?i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"):i.setRequestHeader("X-Pjax","1"),i.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<400&&o(this.responseText)},i.send(n),i=null}function n(e,n){e+=(e.indexOf("?")>0?"&":"?")+"is_ajax=1",t("GET",e,null,n)}function o(e,n,o){t("POST",e,n,o)}function i(){o("./pv","",function(t){e(document.querySelectorAll(".blog_pv"),function(e,n){n.innerHTML=t})})}function l(t){e(t.querySelectorAll(".md_pv"),function(t,n){var i=n.getAttribute("f_time");o("./pv","f_time="+encodeURI(i)+"&time="+(new Date).getTime(),function(t){n.innerHTML=t.split(",")[1];var o=t.split(",")[0];e(document.querySelectorAll(".blog_pv"),function(e,t){t.innerHTML=o})})})}function r(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function d(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function a(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function c(e,t){var n=e;do{if(r(n,t))break;if(!n.parentNode)return null;n=n.parentNode}while(n);return n}function s(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop+document.documentElement.scrollTop,left:t.left+document.body.scrollLeft+document.documentElement.scrollLeft}}function u(e){var t=0;e.style.opacity=0,e.style.filter="",e.style.display="block";var n=+new Date,o=function(){t+=(new Date-n)/400,e.style.opacity=t,e.style.filter="alpha(opacity="+100*t|"0)",n=+new Date,t<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}function m(e,t){if(r(e,"loading"))return!1;d(e,"loading"),e.innerHTML="加载中...";var o=e.getAttribute("href");return n(o,function(t){e.style.display="none","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",o]),i(),e.parentNode.removeChild(e),document.getElementById("blog_list").insertAdjacentHTML("beforeend",t)}),t.preventDefault(),t.stopPropagation(),!1}function f(t,o){var i=c(t,"item_bg"),m=c(i,"item_li"),f=i.querySelector(".item_body"),p=i.querySelector(".content");if(r(i,"item_bg_fixed"))return!1;i.getAttribute("id")||i.setAttribute("id","item_"+(new Date).getTime());var y={id:i.getAttribute("id"),url:i.querySelector(".name").getAttribute("href"),title:i.querySelector(".name").textContent||i.querySelector(".name").innerText,isDetail:1};o&&(window.history.pushState(y,y.title,y.url),document.title=y.title),r(p,"content_load")||n(y.url,function(t){p.innerHTML=t,d(p,"content_load"),e(p.querySelectorAll("pre code"),function(e,t){hljs.highlightBlock(t)})});var w=s(i);w.top=w.top-(document.body.scrollTop+document.documentElement.scrollTop),h=w,g=document.scrollingElement.scrollTop;var v=s(document.getElementById("blog_list")),_=document.getElementById("blog_list").offsetWidth,b=document.body.offsetWidth;d(document.body,"body-prevent-class"),document.body.style.top=-g+"px",document.body.style.width=b+"px",d(i,"item_bg_fixed"),d(i,"item_showing"),f.style.top=w.top+"px",f.style.left=w.left+"px",f.style.width=m.offsetWidth+"px",f.style.height=m.offsetHeight+"px",i.querySelector(".description").style.display="none",u(i.querySelector(".content")),anime.remove(f),anime({targets:f,scale:1,top:0,left:v.left,width:_+"px",height:[{value:"256px",duration:150},{value:"1000px",duration:350},{value:"100pv",duration:300}],duration:800,complete:function(e){f.style.height="auto",f.style.transform="";var t=f.querySelector(".btn_close");t.style.left=v.left+_-t.offsetWidth+"px",a(i,"item_showing"),"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),l(m)}})}function p(){var e=document.querySelector(".item_bg_fixed");if(!e)return!1;var t=c(e,"item_li"),n=e.querySelector(".item_body");e.querySelector(".content");d(e,"item_hiding"),e.querySelector(".content").style.display="none",u(e.querySelector(".description"));var o=h;a(document.body,"body-prevent-class"),document.body.style.top="",document.body.style.width="",document.scrollingElement.scrollTop=g,anime.remove(n),anime({targets:n,scale:1,top:o.top+"px",left:o.left+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px",duration:500,complete:function(t){a(e,"item_bg_fixed"),a(e,"item_hiding"),n.style.top="",n.style.left="",n.style.width="",n.style.height="","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),i()}})}if(document.getElementById("btn_sideshow").onclick=function(){r(document.body,"side_show")?a(document.body,"side_show"):d(document.body,"side_show")},window.onpopstate=function(e){window.history.go(0)},document.getElementById("blog_detail")&&(l(document.getElementById("blog_detail")),e(document.querySelectorAll("pre code"),function(e,t){hljs.highlightBlock(t)})),!document.getElementById("blog_list"))return!1;i();var y=(window.history&&window.history.pushState&&window.history.replaceState&&navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),window.location.href,document.title,{id:(new Date).getTime(),url:window.location.href,title:document.title,isDetail:0});window.history.replaceState(y,y.title,y.url),window.onpopstate=function(e){if(e.state&&e.state.id){if(e.state.isDetail){var t=document.getElementById(""+e.state.id);t?f(t,0):window.history.go(0)}else p();e.state.title&&(document.title=e.state.title)}return!1};var h,g;return document.addEventListener("click",function(e){var t=e.target;return r(t,"btn_loadmore")?m(t,e):r(t,"name")||c(t,"description")?(f(t,1),e.preventDefault(),e.stopPropagation(),!1):r(t,"btn_close")?(window.history.go(-1),e.preventDefault(),e.stopPropagation(),!1):void 0},!1),!1});