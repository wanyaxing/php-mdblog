function ready(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}ready(function(){function e(e,t){for(var n=0;n<e.length;n++)t(n,e[n])}function t(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<400&&t(this.responseText)},n.send(),n=null}function n(){t("./pv.php?f_time=&time="+(new Date).getTime(),function(t){e(document.querySelectorAll(".blog_pv"),function(e,n){n.innerHTML=t})})}function o(n){e(n.querySelectorAll(".md_pv"),function(n,o){var i=o.getAttribute("f_time");t("./pv.php?f_time="+encodeURI(i)+"&time="+(new Date).getTime(),function(t){o.innerHTML=t.split(",")[1];var n=t.split(",")[0];e(document.querySelectorAll(".blog_pv"),function(e,t){t.innerHTML=n})})})}function i(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function l(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function r(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function s(e,t){var n=e;do{if(i(n,t))break;if(!n.parentNode)return null;n=n.parentNode}while(n);return n}function a(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop+document.documentElement.scrollTop,left:t.left+document.body.scrollLeft+document.documentElement.scrollLeft}}function d(e){var t=0;e.style.opacity=0,e.style.filter="",e.style.display="block";var n=+new Date,o=function(){t+=(new Date-n)/400,e.style.opacity=t,e.style.filter="alpha(opacity="+100*t|"0)",n=+new Date,t<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}function c(e,o){if(i(e,"loading"))return!1;l(e,"loading"),e.innerHTML="加载中...";var r=e.getAttribute("href");return t(r+(r.indexOf("?")>0?"&":"?")+"is_ajax=1",function(t){e.style.display="none","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",r]),n(),e.parentNode.removeChild(e),document.getElementById("blog_list").insertAdjacentHTML("beforeend",t)}),o.preventDefault(),o.stopPropagation(),!1}function u(n,c){var u=s(n,"item_bg"),m=s(u,"item_li"),f=u.querySelector(".item_body"),h=u.querySelector(".content");if(i(u,"item_bg_fixed"))return!1;u.getAttribute("id")||u.setAttribute("id","item_"+(new Date).getTime());var g={id:u.getAttribute("id"),url:u.querySelector(".name").getAttribute("href"),title:u.querySelector(".name").textContent||u.querySelector(".name").innerText,isDetail:1};c&&(window.history.pushState(g,g.title,g.url),document.title=g.title),i(h,"content_load")||t(g.url+(g.url.indexOf("?")>0?"&":"?")+"is_ajax=1",function(t){h.innerHTML=t,l(h,"content_load"),e(h.querySelectorAll("pre code"),function(e,t){hljs.highlightBlock(t)})});var w=a(u);w.top=w.top-(document.body.scrollTop+document.documentElement.scrollTop),p=w,y=document.scrollingElement.scrollTop;var _=a(document.getElementById("blog_list")),v=document.getElementById("blog_list").offsetWidth,b=document.body.offsetWidth;l(document.body,"body-prevent-class"),document.body.style.top=-y+"px",document.body.style.width=b+"px",l(u,"item_bg_fixed"),l(u,"item_showing"),f.style.top=w.top+"px",f.style.left=w.left+"px",f.style.width=m.offsetWidth+"px",f.style.height=m.offsetHeight+"px",u.querySelector(".description").style.display="none",d(u.querySelector(".content")),anime.remove(f),anime({targets:f,scale:1,top:0,left:_.left,width:v+"px",height:[{value:"256px",duration:150},{value:"1000px",duration:350},{value:"100pv",duration:300}],duration:800,complete:function(e){f.style.height="auto",f.style.transform="";var t=f.querySelector(".btn_close");t.style.left=_.left+v-t.offsetWidth+"px",r(u,"item_showing"),"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),o(m)}})}function m(){var e=document.querySelector(".item_bg_fixed");if(!e)return!1;var t=s(e,"item_li"),o=e.querySelector(".item_body");e.querySelector(".content");l(e,"item_hiding"),e.querySelector(".content").style.display="none",d(e.querySelector(".description"));var i=p;r(document.body,"body-prevent-class"),document.body.style.top="",document.body.style.width="",document.scrollingElement.scrollTop=y,anime.remove(o),anime({targets:o,scale:1,top:i.top+"px",left:i.left+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px",duration:500,complete:function(t){r(e,"item_bg_fixed"),r(e,"item_hiding"),o.style.top="",o.style.left="",o.style.width="",o.style.height="","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),n()}})}if(document.getElementById("btn_sideshow").onclick=function(){var e=document.getElementById("side_list");if(e.classList)e.classList.toggle("side_show");else{for(var t=e.className.split(" "),n=-1,o=t.length;o--;)"side_show"===t[o]&&(n=o);n>=0?t.splice(n,1):t.push("side_show"),e.className=t.join(" ")}},window.onpopstate=function(e){window.history.go(0)},hljs.initHighlightingOnLoad(),document.getElementById("blog_detail")&&o(document.getElementById("blog_detail")),!document.getElementById("blog_list"))return!1;n();var f=(window.history&&window.history.pushState&&window.history.replaceState&&navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),window.location.href,document.title,{id:(new Date).getTime(),url:window.location.href,title:document.title,isDetail:0});window.history.replaceState(f,f.title,f.url),window.onpopstate=function(e){if(e.state&&e.state.id){if(e.state.isDetail){var t=document.getElementById(""+e.state.id);t?u(t,0):window.history.go(0)}else m();e.state.title&&(document.title=e.state.title)}return!1};var p,y;return document.addEventListener("click",function(e){var t=e.target;return i(t,"btn_loadmore")?c(t,e):i(t,"name")||s(t,"description")?(u(t,1),e.preventDefault(),e.stopPropagation(),!1):i(t,"btn_close")?(window.history.go(-1),e.preventDefault(),e.stopPropagation(),!1):void 0},!1),!1});