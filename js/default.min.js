function ready(t){"loading"!=document.readyState?t():document.addEventListener?document.addEventListener("DOMContentLoaded",t):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&t()})}function afterLoad(t){"complete"==document.readyState?t():window.addEventListener?window.addEventListener("load",t,!1):window.attachEvent?window.attachEvent("onload",t):window.onload=t}afterLoad(function(){function t(t,e){for(var n=0;n<t.length;n++)e(n,t[n])}function e(t,e,n,o){var i=new XMLHttpRequest;i.open(t,e,!0),"POST"==t?i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"):i.setRequestHeader("X-Pjax","1"),i.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<400&&o(this.responseText)},i.send(n),i=null}function n(t,n){t+=(t.indexOf("?")>0?"&":"?")+"is_ajax=1",e("GET",t,null,n)}function o(t,n,o){e("POST",t,n,o)}function i(){o("./pv","",function(e){t(document.querySelectorAll(".blog_pv"),function(t,n){n.innerHTML=e})})}function l(e){t(e.querySelectorAll(".md_pv"),function(e,n){var i=n.getAttribute("f_time");o("./pv","f_time="+encodeURI(i)+"&time="+(new Date).getTime(),function(e){n.innerHTML=e.split(",")[1];var o=e.split(",")[0];t(document.querySelectorAll(".blog_pv"),function(t,e){e.innerHTML=o})})})}function d(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function r(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function a(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function c(t,e){var n=t;do{if(d(n,e))break;if(!n.parentNode)return null;n=n.parentNode}while(n);return n}function s(t){var e=t.getBoundingClientRect();return{top:e.top+document.body.scrollTop+document.documentElement.scrollTop,left:e.left+document.body.scrollLeft+document.documentElement.scrollLeft}}function u(t){var e=0;t.style.opacity=0,t.style.filter="",t.style.display="block";var n=+new Date,o=function(){e+=(new Date-n)/400,t.style.opacity=e,t.style.filter="alpha(opacity="+100*e|"0)",n=+new Date,e<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}function m(t,e){if(d(t,"loading"))return!1;r(t,"loading"),t.innerHTML="加载中...";var o=t.getAttribute("href");return n(o,function(e){t.style.display="none","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",o]),i(),t.parentNode.removeChild(t),document.getElementById("blog_list").insertAdjacentHTML("beforeend",e)}),e.preventDefault(),e.stopPropagation(),!1}function f(e,o){var i=c(e,"item_bg"),m=c(i,"item_li"),f=i.querySelector(".item_body"),p=i.querySelector(".content");if(d(i,"item_bg_fixed"))return!1;i.getAttribute("id")||i.setAttribute("id","item_"+(new Date).getTime());var y={id:i.getAttribute("id"),url:i.querySelector(".name").getAttribute("href"),title:i.querySelector(".name").textContent||i.querySelector(".name").innerText,isDetail:1};o&&(window.history.pushState(y,y.title,y.url),document.title=y.title),d(p,"content_load")||n(y.url,function(e){p.innerHTML=e,r(p,"content_load"),t(p.querySelectorAll("pre code"),function(t,e){hljs.highlightBlock(e)})});var w=s(i);w.top=w.top-(document.body.scrollTop+document.documentElement.scrollTop),h=w,g=document.scrollingElement.scrollTop;var v=s(document.getElementById("blog_list")),_=document.getElementById("blog_list").offsetWidth,b=document.body.offsetWidth;r(document.body,"body-prevent-class"),document.body.style.top=-g+"px",document.body.style.width=b+"px",r(i,"item_bg_fixed"),r(i,"item_showing"),f.style.top=w.top+"px",f.style.left=w.left+"px",f.style.width=m.offsetWidth+"px",f.style.height=m.offsetHeight+"px",i.querySelector(".description").style.display="none",u(i.querySelector(".content")),anime.remove(f),anime({targets:f,scale:1,top:0,left:v.left,width:_+"px",height:[{value:"256px",duration:150},{value:"1000px",duration:350},{value:"100pv",duration:300}],duration:800,complete:function(t){f.style.height="auto",f.style.transform="";var e=f.querySelector(".btn_close");e.style.left=v.left+_-e.offsetWidth+"px",a(i,"item_showing"),"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),l(m)}})}function p(){var t=document.querySelector(".item_bg_fixed");if(!t)return!1;var e=c(t,"item_li"),n=t.querySelector(".item_body");t.querySelector(".content");r(t,"item_hiding"),t.querySelector(".content").style.display="none",u(t.querySelector(".description"));var o=h;a(document.body,"body-prevent-class"),document.body.style.top="",document.body.style.width="",document.scrollingElement.scrollTop=g,anime.remove(n),anime({targets:n,scale:1,top:o.top+"px",left:o.left+"px",width:e.offsetWidth+"px",height:e.offsetHeight+"px",duration:500,complete:function(e){a(t,"item_bg_fixed"),a(t,"item_hiding"),n.style.top="",n.style.left="",n.style.width="",n.style.height="","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href]),i()}})}if(document.getElementById("btn_sideshow").onclick=function(){d(document.body,"side_show")?a(document.body,"side_show"):r(document.body,"side_show")},window.onpopstate=function(t){window.history.go(0)},hljs.initHighlightingOnLoad(),document.getElementById("blog_detail")&&l(document.getElementById("blog_detail")),!document.getElementById("blog_list"))return!1;i();var y=(window.history&&window.history.pushState&&window.history.replaceState&&navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),window.location.href,document.title,{id:(new Date).getTime(),url:window.location.href,title:document.title,isDetail:0});window.history.replaceState(y,y.title,y.url),window.onpopstate=function(t){if(t.state&&t.state.id){if(t.state.isDetail){var e=document.getElementById(""+t.state.id);e?f(e,0):window.history.go(0)}else p();t.state.title&&(document.title=t.state.title)}return!1};var h,g;return document.addEventListener("click",function(t){var e=t.target;return d(e,"btn_loadmore")?m(e,t):d(e,"name")||c(e,"description")?(f(e,1),t.preventDefault(),t.stopPropagation(),!1):d(e,"btn_close")?(window.history.go(-1),t.preventDefault(),t.stopPropagation(),!1):void 0},!1),!1});