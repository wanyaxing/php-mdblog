ready(function(){function t(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function e(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function o(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function n(e,o){var n=e;do{if(t(n,o))break;if(!n.parentNode)return e;n=n.parentNode}while(n);return n}function i(t){var e=t.getBoundingClientRect();return{top:e.top+document.body.scrollTop+document.documentElement.scrollTop,left:e.left+document.body.scrollLeft+document.documentElement.scrollLeft}}function l(t){var e=0;t.style.opacity=0,t.style.filter="",t.style.display="block";var o=+new Date,n=function(){e+=(new Date-o)/400,t.style.opacity=e,t.style.filter="alpha(opacity="+100*e|"0)",o=+new Date,e<1&&(window.requestAnimationFrame&&requestAnimationFrame(n)||setTimeout(n,16))};n()}function r(t,e){var o=new XMLHttpRequest;o.open("GET",t,!0),o.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<400&&e(this.responseText)},o.send(),o=null}function a(o,n){if(t(o,"loading"))return!1;e(o,"loading"),o.innerHTML="加载中...";var i=o.getAttribute("href");return r(i+(i.indexOf("?")>0?"&":"?")+"is_ajax=1",function(t){o.style.display="none","undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",i]),o.parentNode.removeChild(o),document.getElementById("blog_list").insertAdjacentHTML("beforeend",t)}),n.preventDefault(),n.stopPropagation(),!1}function s(a,s){var d=n(a,"item_bg"),c=n(d,"item_li"),p=d.querySelector(".item_body"),f=d.querySelector(".content");if(t(d,"item_bg_fixed"))return!1;d.getAttribute("id")||d.setAttribute("id","item_"+(new Date).getTime());var y={id:d.getAttribute("id"),url:d.querySelector(".name").getAttribute("href"),title:d.querySelector(".name").textContent||d.querySelector(".name").innerText,isDetail:1};s&&(window.history.pushState(y,y.title,y.url),document.title=y.title),t(f,"content_load")||r(y.url+(y.url.indexOf("?")>0?"&":"?")+"is_ajax=1",function(t){f.innerHTML=t,e(f,"content_load")});var h=i(d);h.top=h.top-(document.body.scrollTop+document.documentElement.scrollTop),u=h,m=document.scrollingElement.scrollTop;var g=document.body.offsetWidth;e(document.body,"body-prevent-class"),document.body.style.top=-m+"px",document.body.style.width=g+"px",e(d,"item_bg_fixed"),e(d,"item_showing"),p.style.top=h.top+"px",p.style.left=h.left+"px",p.style.width=c.offsetWidth+"px",p.style.height=c.offsetHeight+"px",d.querySelector(".description").style.display="none",l(d.querySelector(".content")),anime.remove(p),anime({targets:p,scale:1,top:0,left:i(document.getElementById("blog_list")).left,width:document.getElementById("blog_list").offsetWidth+"px",height:[{value:"256px",duration:150},{value:"1000px",duration:350},{value:"100pv",duration:300}],duration:800,complete:function(t){p.style.height="auto",o(d,"item_showing"),"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href])}})}function d(){var t=document.querySelector(".item_bg_fixed");if(!t)return!1;var i=n(t,"item_li"),r=t.querySelector(".item_body");t.querySelector(".content");e(t,"item_hiding"),t.querySelector(".content").style.display="none",l(t.querySelector(".description"));var a=u;anime.remove(r),anime({targets:r,scale:1,top:a.top+"px",left:a.left+"px",width:i.offsetWidth+"px",height:i.offsetHeight+"px",duration:500,complete:function(e){o(t,"item_bg_fixed"),o(t,"item_hiding"),r.style.top="",r.style.left="",r.style.width="",r.style.height="",o(document.body,"body-prevent-class"),document.body.style.top="",document.body.style.width="",document.scrollingElement.scrollTop=m,"undefined"!=typeof _hmt&&_hmt.push(["_trackPageview",window.location.href])}})}var c=(window.history&&window.history.pushState&&window.history.replaceState&&navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),window.location.href,document.title,{id:(new Date).getTime(),url:window.location.href,title:document.title,isDetail:0});window.history.replaceState(c,c.title,c.url),window.onpopstate=function(t){if(t.state&&t.state.id){if(t.state.isDetail){var e=document.getElementById(""+t.state.id);e?s(e,0):window.history.go(0)}else d();t.state.title&&(document.title=t.state.title)}return!1};var u,m;return document.addEventListener("click",function(e){var o=e.target;return t(o,"btn_loadmore")?a(o,e):t(o,"description")||t(o,"name")?(s(o,1),e.preventDefault(),e.stopPropagation(),!1):t(o,"btn_close")?(window.history.go(-1),e.preventDefault(),e.stopPropagation(),!1):void 0},!1),!1});